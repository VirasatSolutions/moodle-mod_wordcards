/**
 * JQuery Flip plugin module.
 *
 * @package mod_wordcards
 * @author  Justin Hunt - poodll.com
 * (based on https://github.com/nnattawat/flip)
 */

define([
    'jquery'
], function($) {
alert('test');
 if(window.matchMedia("(max-width: 767px)").matches){
        // The viewport is less than 768 pixels wide
   var definition_flashcards_ul = $('.definition_flashcards_ul li').length;
   $('.wrapper_pr').html('<div class="mb_nav"><span class="curr_level_card">1</span> / <span class="tot_level_card">'+definition_flashcards_ul+'</span></div>');
   $('.ProgressBar').hide();
   } else{
        // The viewport is at least 768 pixels wide
   //     alert("This is a tablet or desktop.");
    }
   $('.event_grid').click(function(){
   	$('.definition_flashcards').show();
   	$('.definition_grid').hide();
   });
   $('.event_flashcards').click(function(){
   	$('.definition_flashcards').hide();
   	$('.definition_grid').show();
   });
   
   $(".definition_flashcards_ul li:gt(0)").hide();
    var $bar = $(".ProgressBar");
     $bar.children("li:first").addClass('is-current');
    check_prev_level();
   check_next_level();
   
   $('#Next').click(function(){
   check_prev_level();
   check_next_level();
     $('.definition_flashcards_ul > li:first')
       .slideUp(400)
       .next()
       .slideDown(400)
       .end()
       .appendTo('.definition_flashcards_ul').slideUp(400);
   check_prev_level();
   check_next_level();
   });
   
   $('#Prev').click(function(){
   check_prev_level();
   check_next_level();
     $('.definition_flashcards_ul > li:last')
       .slideDown(400)
       .prev()
       .slideUp(400)
       .end()
       .prependTo('.definition_flashcards_ul');
   $(".definition_flashcards_ul li:gt(0)").slideUp(400);
   
   check_prev_level();
   check_next_level();
   });
   
   //Uses jQuery because it was quick. You'll want to write something that works within the context of your app.
   
   $("#Next").on("click", function() {
   
   var  curr_level_card = $('.curr_level_card').html();
   $('.curr_level_card').html(parseInt(curr_level_card)+1);
   
     var $bar = $(".ProgressBar");
     if ($bar.children(".is-current").length > 0) {
       $bar.children(".is-current").removeClass("is-current").addClass("is-complete").next().addClass("is-current");
     } else {
       $bar.children().first().addClass("is-current");
     }
   check_prev_level();
   check_next_level();
   });
   
   $("#Prev").on("click", function() {
    var  curr_level_card = $('.curr_level_card').html();
   $('.curr_level_card').html(parseInt(curr_level_card)-1);
     var $bar = $(".ProgressBar");
     if ($bar.children(".is-current").length > 0) {
       $bar.children(".is-current").removeClass("is-current").prev().removeClass("is-complete").addClass("is-current");
     } else {
       $bar.children(".is-complete").last().removeClass("is-complete").addClass("is-current");
     }
   check_prev_level();
   check_next_level();
   });
 
   
   function check_prev_level(){
   	 var $bar = $(".ProgressBar");
   	 if($bar.children("li:first").hasClass('is-current')===true){
   		$('#Prev').attr('disabled','disabled').addClass('add_opacity_level');
   		return true;
   	 } 
   	 
   	 $('#Prev').removeAttr('disabled');
   	 $('#Prev').removeAttr('disabled').removeClass('add_opacity_level');
   }
   
   
   function check_next_level(){
   	 var $bar = $(".ProgressBar");
   	  if($bar.children("li:last").hasClass('is-current')===true){
   		$('#Next').attr('disabled','disabled').addClass('add_opacity_level');
     			return true;
   		} 
   	 $('#Next').removeAttr('disabled').removeClass('add_opacity_level');
     }
});
