define ("mod_wordcards/matchselect",["jquery","core/ajax","core/log","mod_wordcards/a4e","core/templates"],function(a,b,c,d,e){var f={dryRun:!1,init:function init(b){var e="#"+b.widgetid;this.dryRun=b.dryRun;this.nexturl=b.nexturl;var g=a(e).get(0);if(g){var h=JSON.parse(g.value);a(e).remove()}else{c.debug("No config found on page. Giving up.");return}f.process(h);d.register_events();this.register_events()},register_events:function register_events(){a("#next-button").on("click",function(){f.next()});a("body").on("click","#close-results",function(){var a=d.calc_total_time(f.results),b=f.nexturl.replace(/&amp;/g,"&")+"&localscattertime="+a;window.location.replace(b)});a("body").on("click","#try-again",function(){location.reload()});a("body").on("click",".a4e-distractor",function(){f.check(a(this).data("correct"),this)});a("body").on("click","#start-button",function(){f.start()});a("body").on("click","#quit-button",function(){f.quit()})},process:function process(a){f.terms=a.terms;f.has_images=a.has_images;d.list_vocab("#vocab-list-inner",f.terms)},start:function start(){f.results=[];d.shuffle(f.terms);f.pointer=0;a("#vocab-list, #start-button").hide();a("#gameboard, #quit-button").show();a("#time-counter").text("00:00");f.timer={interval:setInterval(function(){f.timer.update()},1e3),count:0,update:function update(){f.timer.count++;a("#time-counter").text(d.pretty_print_secs(f.timer.count))}};f.next()},quit:function quit(){clearInterval(f.timer.interval);a("#gameboard, #quit-button").hide();a("#vocab-list, #start-button").show()},end:function end(){clearInterval(f.timer.interval);a("#gameboard, #quit-button, #start-button").hide();a("#results").show();var b=[];b.results=f.results;b.total=f.terms.length;b.totalcorrect=d.calc_total_points(f.results);var c=d.calc_total_time(f.results);if(0==c){b.prettytime="00:00"}else{b.prettytime=d.pretty_print_secs(c)}e.render("mod_wordcards/feedback",b).then(function(b){a("#results-inner").html(b)});var g={results:f.results,activity:"match_select"};console.log(g)},next:function next(){a("#next-button").hide();d.progress_dots(f.results,f.terms);if(""!==f.terms[f.pointer].definition&&""!=f.terms[f.pointer].term){if(null!==f.terms[f.pointer].image&&""!=f.terms[f.pointer].image){a("#question").html("<img style='height:200px;width:auto;' class='center-block img-responsive img-thumbnail' src='"+f.terms[f.pointer].image+"'><br/>")}else if(f.has_images&&(null==f.terms[f.pointer].image||""==f.terms[f.pointer].image)){a("#question").html("<img style='height:200px;width:auto;' class='center-block img-responsive img-thumbnail' src='/images/no-image.png'><br/>")}a("#question").append("<strong>"+f.terms[f.pointer].definition+"</strong>")}else if(null!==f.terms[f.pointer].image&&""!=f.terms[f.pointer].image){a("#question").html("<img class='center-block img-responsive img-thumbnail' src='"+f.terms[f.pointer].image+"'>")}else{d.alert("Could not generate a test with these settings!","error");f.end()}a("#input").html(f.get_distractors())},check:function check(b,c){var d=0;if(!0==b){d=1}a(".a4e-distractor").css("pointer-events","none");var e={question:f.terms[f.pointer].definition,selected:a(c).text(),correct:f.terms[f.pointer].term,points:d,time:f.timer.count};f.timer.count=0;f.results.push(e);var g=!0==b?"a4e-correct":"a4e-incorrect";a(c).addClass(g).append("<i style='color:"+(b?"green":"red")+";margin-left:5px;' class='fa fa-"+(b?"check":"times")+"'></i>").parent().addClass("a4e-click-disabled");if(!b){a(".a4e-distractor[data-correct='true']").addClass("a4e-correct").append("<i style='color:green;margin-left:5px;' class='fa fa-check'></i>")}if(b){this.reportSuccess(f.terms[f.pointer].id)}else{this.reportFailure(f.terms[f.pointer].id,a(c).data("id"))}f.pointer++;if(!b){setTimeout(function(){if(f.pointer<f.terms.length){a("#next-button").trigger("click")}else{f.end()}},1500)}else{setTimeout(function(){if(f.pointer<f.terms.length){a("#next-button").trigger("click")}else{f.end()}},1e3)}},get_distractors:function get_distractors(){var b=f.terms.slice(0),c=f.terms[f.pointer].term;b.splice(f.pointer,1);d.shuffle(b);b=b.slice(0,4);b.push(f.terms[f.pointer]);d.shuffle(b);var e=[];a.each(b,function(a,b){var d=b.term==c,f=b.id;e.push("<li data-id=\""+f+"\" data-correct=\""+d.toString()+"\" class=\"list-group-item a4e-distractor a4e-noselect\">"+b.term+"</li>")});var g="<ul class=\"list-group a4e-distractors\">"+e.join("")+"</ul>";return g},reportFailure:function reportFailure(a,c){if(this.dryRun){return}b.call([{methodname:"mod_wordcards_report_failed_association",args:{term1id:a,term2id:c}}])},reportSuccess:function reportSuccess(a){if(this.dryRun){return}b.call([{methodname:"mod_wordcards_report_successful_association",args:{termid:a}}])}};return f});
//# sourceMappingURL=matchselect.min.js.map
