{"version":3,"sources":["../src/definitions.js"],"names":["define","$","Ajax","Notification","init","opts","container","modid","canmanage","btn","find","seenAll","length","on","e","preventDefault","termNode","parents","first","termId","data","addClass","call","then","result","Deferred","reject","fail","exception","always","removeClass","prop","click","location","href"],"mappings":"AAAAA,OAAM,6BAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAAD,CAA+C,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgC,CACnF,aAEA,MAAO,CAELC,IAAI,CAAE,cAASC,CAAT,CAAe,CAEnB,GAAIC,CAAAA,CAAS,CAAGL,CAAC,CAAC,qBAAuBI,CAAI,OAA5B,CAAjB,CACEE,CAAK,CAAGF,CAAI,MADd,CAEEG,CAAS,CAAGH,CAAI,UAFlB,CAGEI,CAAG,CAAGH,CAAS,CAACI,IAAV,CAAe,kBAAf,CAHR,CAKA,QAASC,CAAAA,CAAT,EAAmB,CACjB,MAAOL,CAAAA,CAAS,CAACI,IAAV,CAAe,OAAf,EAAwBE,MAAxB,GAAmCN,CAAS,CAACI,IAAV,CAAe,iBAAf,EAAkCE,MAC7E,CAEDN,CAAS,CAACO,EAAV,CAAa,OAAb,CAAsB,mBAAtB,CAA2C,SAASC,CAAT,CAAY,CACrDA,CAAC,CAACC,cAAF,GAEA,GAAIC,CAAAA,CAAQ,CAAGf,CAAC,CAAC,IAAD,CAAD,CAAQgB,OAAR,CAAgB,OAAhB,EAAyBC,KAAzB,EAAf,CACEC,CAAM,CAAGH,CAAQ,CAACI,IAAT,CAAc,QAAd,CADX,CAIAJ,CAAQ,CAACK,QAAT,CAAkB,cAAlB,EACAnB,CAAI,CAACoB,IAAL,CAAU,CAAC,CACP,WAAc,4BADP,CAEP,KAAQ,CACN,OAAUH,CADJ,CAFD,CAAD,CAAV,EAKM,CALN,EAKSI,IALT,CAKc,SAASC,CAAT,CAAiB,CAC3B,GAAI,CAACA,CAAL,CAAa,CACX,MAAOvB,CAAAA,CAAC,CAACwB,QAAF,GAAaC,MAAb,EACR,CACDV,CAAQ,CAACK,QAAT,CAAkB,WAAlB,CACD,CAVH,EAWGM,IAXH,CAWQxB,CAAY,CAACyB,SAXrB,EAYGC,MAZH,CAYU,UAAW,CACjBb,CAAQ,CAACc,WAAT,CAAqB,cAArB,EACA,GAAInB,CAAO,EAAX,CAAe,CACbF,CAAG,CAACsB,IAAJ,CAAS,UAAT,IACD,CACF,CAjBH,CAkBD,CA1BD,EA6BA,GAAI,CAACpB,CAAO,EAAR,EAAc,CAACH,CAAnB,CAA8B,CAC5BC,CAAG,CAACsB,IAAJ,CAAS,UAAT,IACD,CAEDtB,CAAG,CAACuB,KAAJ,CAAU,SAASlB,CAAT,CAAY,CACpBA,CAAC,CAACC,cAAF,GACAkB,QAAQ,CAACC,IAAT,CAAgBjC,CAAC,CAAC,IAAD,CAAD,CAAQmB,IAAR,CAAa,MAAb,CACjB,CAHD,CAKD,CAnDI,CAuDR,CA1DK,CAAN","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n  \"use strict\"; // jshint ;_;\n\n  return {\n\n    init: function(opts) {\n\n      var container = $('#definitions-page-' + opts['uniqid']),\n        modid = opts['modid'],\n        canmanage = opts['canmanage'],\n        btn = container.find('.continue-button');\n\n      function seenAll() {\n        return container.find('.term').length === container.find('.term.term-seen').length\n      }\n\n      container.on('click', '.term-seen-action', function(e) {\n        e.preventDefault();\n\n        var termNode = $(this).parents('.term').first(),\n          termId = termNode.data('termid');\n\n        // TODO Ajax.\n        termNode.addClass('term-loading')\n        Ajax.call([{\n            'methodname': 'mod_wordcards_mark_as_seen',\n            'args': {\n              'termid': termId\n            }\n          }])[0].then(function(result) {\n            if (!result) {\n              return $.Deferred().reject();\n            }\n            termNode.addClass('term-seen');\n          })\n          .fail(Notification.exception)\n          .always(function() {\n            termNode.removeClass('term-loading');\n            if (seenAll()) {\n              btn.prop('disabled', false);\n            }\n          });\n      });\n\n      // Teachers can jump to the next steps.\n      if (!seenAll() && !canmanage) {\n        btn.prop('disabled', true);\n      }\n\n      btn.click(function(e) {\n        e.preventDefault();\n        location.href = $(this).data('href');\n      });\n\n    }\n\n  }\n\n});"],"file":"definitions.min.js"}