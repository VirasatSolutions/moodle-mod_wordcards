define(["jquery","core/ajax","core/notification","mod_wordcards/a4e"],function(a,b,c,d){"use strict";return{init:function(e){function f(){return j.find(".term").length===j.find(".term.term-seen").length}var g="#"+e.widgetid,h=a(g).get(0);if(!h)return void log.debug("No config found on page. Giving up.");var i=JSON.parse(h.value);this.props=i,a(g).remove();var j=a("#definitions-page-"+e.widgetid),k=(i.modid,i.canmanage),l=j.find(".continue-button");d.register_events(),d.init_audio(i.token,i.region,i.owner),j.on("click",".term-seen-action",function(d){d.preventDefault();var e=a(this).parents(".term").first(),g=e.data("termid");e.addClass("term-loading"),b.call([{methodname:"mod_wordcards_mark_as_seen",args:{termid:g}}])[0].then(function(b){return b?void e.addClass("term-seen"):a.Deferred().reject()}).fail(c.exception).always(function(){e.removeClass("term-loading"),f()&&l.prop("disabled",!1)})}),f()||k||l.prop("disabled",!0),l.click(function(b){b.preventDefault(),location.href=a(this).data("href")})}}});