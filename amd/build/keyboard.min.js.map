{"version":3,"sources":["../src/keyboard.js"],"names":["define","$","templates","keyboard","string","letters","qwerty","mobile_user","test","navigator","userAgent","shuffle","a","j","x","i","length","Math","floor","random","flash","target","classname","addClass","setTimeout","removeClass","off","clear","remove","disable","text","create","id","show_dist","func","distractors","each","split","l","indexOf","push","splice","concat","slice","sort","letter","item","charcode","charCodeAt","tdata","render","then","html","on","press","e","preventDefault","code","substring","key","which","trigger","button","value","String","fromCharCode","data","old","new"],"mappings":"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","sourcesContent":["/**\n * Keyboard Helper\n *\n * @package mod_wordcards\n * @author  Justin Hunt - poodll.com\n * * (based on Paul Raine's APPs 4 EFL)\n */\n\ndefine(['jquery','core/templates'], function($,templates) {\n\n    var keyboard={\n        string:\"\",\n        letters:[],\n        qwerty:[\n            ['q','w','e','r','t','y','u','i','o','p'],\n            ['a','s','d','f','g','h','j','k','l'],\n            ['z','x','c','v','b','n','m']\n        ],\n        mobile_user:function(){\n            if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        },\n        shuffle:function(a) {\n            var j, x, i;\n            for (i = a.length; i; i -= 1) {\n                j = Math.floor(Math.random() * i);\n                x = a[i - 1];\n                a[i - 1] = a[j];\n                a[j] = x;\n            }\n        },\n        flash:function(target,classname){\n            $(target).addClass(classname);\n            setTimeout(function(){\n                $(target).removeClass(classname);\n            }, 100);\n        },\n        off:function(){\n            $(\"body\").off(keyboard.mobile_user()?'touchstart':'click',\".chunk-key\").off(\"click\",\"#delete-chunk-input\").off(\"click\",\"#clear-chunk-input\").off(\"click\",\"#submit-chunk-input\").off(\"keypress\").off(\"keydown\");\n        },\n        clear:function(){\n            keyboard.off();\n            $(\"#chunk-input\").remove();\n        },\n        disable:function(){\n            keyboard.off();\n            $(\"#chunk-typed-inner\").text(\"\");\n            $(\"#chunk-input\").addClass(\"chunk-input-disabled\");\n        },\n        create:function(target,string,id,show_dist,func){\n            var distractors=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];\n            keyboard.string=string;\n            keyboard.clear();\n            keyboard.letters=[];\n            $.each(string.split(''),function(i,l){\n                if(keyboard.letters.indexOf(l)==-1){\n                    keyboard.letters.push(l);\n                    distractors.splice(distractors.indexOf(l),1);\n                }\n            });\n            keyboard.shuffle(distractors);\n            if(show_dist){\n                keyboard.letters=keyboard.letters.concat(distractors.slice(0,3));\n            }\n            keyboard.letters.sort();\n            var letters=[];\n            $.each(keyboard.letters,function(i,letter){\n                var item ={};\n                item.charcode = letter.charCodeAt(0);\n                if(letter==' '){\n                    item.letter='&nbsp;';\n                }else{\n                    item.letter=letter;\n                }\n                letters.push(item);\n            });\n            var tdata=[];\n            tdata['letters'] = letters;\n            templates.render('mod_wordcards/keyboard',tdata).then(\n                function(html,js){\n                    $(\"#\"+target).html(html);\n                }\n            );\n\n/*\n            var code=\"<div id='chunk-input' data-id='\"+id+\"' class='noselect'>\";\n            code+=\"<div id='chunk-typed'><div id='chunk-typed-inner'></div></div>\";\n            $.each(keyboard.letters,function(i,letter){\n                code+=\"<div class='chunk-key' data-val='\"+letter.charCodeAt(0)+\"'><div class='chunk-key-inner'>\"+(letter==\" \"?\"&nbsp;\":letter)+\"</div></div>\";\n            });\n            code+=\"<div id='chunk-input-controls'>\";\n            code+=\"<div id='delete-chunk-input' class='btn-primary chunk-input-control'><i class='fa fa-caret-square-o-left'></i> Delete</div>\";\n            code+=\"<div id='submit-chunk-input' class='btn-success chunk-input-control'>Submit <i class='fa fa-arrow-circle-right'></i></div>\";\n            code+=\"</div>\";\n\n            code+=\"</div>\";\n            */\n\n            $(\"body\").on(keyboard.mobile_user()?'touchstart':'click',\".chunk-key\",function(){\n                var text=$(\"#chunk-typed-inner\").text();\n                if(text.length<string.length){\n                    //createjs.Sound.play('click');\n                    keyboard.press(this,func);\n                }\n                else{\n                    keyboard.flash(\"#chunk-typed-inner\",\"a4e-incorrect\");\n                    //createjs.Sound.play('cancel');\n                }\n            });\n            $(\"body\").on(\"touchmove\",\"#\"+target,function(e){\n                e.preventDefault();\n            });\n            $(\"body\").on(\"click\",\"#delete-chunk-input\",function(){\n                var text=$(\"#chunk-typed-inner\").text();\n                var code=text.slice(-1).charCodeAt(0);\n                $(\"#chunk-typed-inner\").text(text.substring(0,text.length-1));\n                //$(\".chunk-key[data-val='\"+code+\"'].a4e-key-disabled:last\").removeClass('a4e-key-disabled');\n            });\n            $(\"body\").on(\"click\",\"#submit-chunk-input\",function(){\n                var text=$(\"#chunk-typed-inner\").text();\n                func(text);\n            });\n            $(\"body\").on(\"keydown\",function(e){\n                var key=e.which;\n                if([0,8,46].indexOf(key)!=-1){\n                    $(\"#delete-chunk-input\").trigger(\"click\");\n                    e.preventDefault();\n                }\n                else if(e.which==13){\n                    $(\"#submit-chunk-input\").trigger(\"click\");\n                    e.preventDefault();\n                }\n            });\n            $(\"body\").on('keypress',function(e){\n\n                var text=$(\"#chunk-typed-inner\").text();\n                var key=e.which;\n                //var button=$(\".chunk-key[data-val='\"+key+\"']:not(.a4e-key-disabled)\").first();\n                var button=$(\".chunk-key[data-val='\"+key+\"']\");\n                if(button.length && text.length<string.length){\n                    keyboard.press(button,func);\n                }\n                else{\n                    keyboard.flash(\"#chunk-typed-inner\",\"a4e-incorrect\");\n                    //createjs.Sound.play('cancel');\n                }\n                e.preventDefault();\n\n            });\n        },\n        press:function(target,func){\n            var value=String.fromCharCode($(target).data(\"val\"));\n            keyboard.flash(target,\"a4e-key-pressed\");\n            var text={old:$(\"#chunk-typed-inner\").text()};\n            text.new=text.old+value;\n            if(text.new.length<=keyboard.string.length){\n                $(\"#chunk-typed-inner\").text(text.new);\n                //$(target).addClass('a4e-key-disabled');\n            }\n            else{\n                keyboard.flash(\"#chunk-typed-inner\",\"a4e-incorrect\");\n                //createjs.Sound.play('cancel');\n            }\n        }\n    };\n\n    return keyboard;\n\n});\n"],"file":"keyboard.min.js"}