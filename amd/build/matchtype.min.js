define ("mod_wordcards/matchtype",["jquery","core/ajax","core/log","mod_wordcards/a4e","mod_wordcards/keyboard","core/templates"],function(a,b,c,d,e,f){var g={dryRun:!1,init:function init(b){var e="#"+b.widgetid;this.dryRun=b.dryRun;this.nexturl=b.nexturl;var f=a(e).get(0);if(f){var h=JSON.parse(f.value);a(e).remove()}else{c.debug("No config found on page. Giving up.");return}g.process(h);d.register_events();this.register_events()},register_events:function register_events(){a("#next-button").on("click",function(){g.next()});a("body").on("click","#close-results",function(){var a=d.calc_total_time(g.results);window.location.replace(g.nexturl.replace(/&amp;/g,"&")+"&localscattertime="+a)});a("body").on("click","#start-button",function(){g.start()});a("body").on("click","#quit-button",function(){g.quit()})},process:function process(a){g.terms=a.terms;g.has_images=a.has_images;d.list_vocab("#vocab-list-inner",g.terms)},start:function start(){g.results=[];d.shuffle(g.terms);g.pointer=0;a("#vocab-list, #start-button").hide();a("#gameboard, #quit-button").show();a("#time-counter").text("00:00");a("#progress-correct").css("width","0%");a("#progress-incorrect").css("width","0%");g.timer={interval:setInterval(function(){g.timer.update()},1e3),count:0,update:function update(){g.timer.count++;a("#time-counter").text(d.pretty_print_secs(g.timer.count))}};g.next()},quit:function quit(){e.clear();clearInterval(g.timer.interval);a("#gameboard, #quit-button").hide();a("#vocab-list, #start-button").show()},end:function end(){e.clear();clearInterval(g.timer.interval);a("#gameboard, #quit-button, #start-button").hide();a("#results").show();var b=[];b.results=g.results;b.total=g.terms.length;b.totalcorrect=d.calc_total_points(g.results);var c=d.calc_total_time(g.results);if(0==c){b.prettytime="00:00"}else{b.prettytime=d.pretty_print_secs(c)}f.render("mod_wordcards/feedback",b).then(function(b){a("#results-inner").html(b)});var h={results:g.results,activity:"match_type"};console.log(h)},next:function next(){a("#next-button").hide();a("#submitted").html("").removeClass("a4e-correct a4e-incorrect");e.create("input",g.terms[g.pointer].term,g.pointer,!0,function(b){a("#submitted").html(g.terms[g.pointer].term);e.disable();g.check(b)});a("#question-counter").text(g.pointer+1+"/"+g.terms.length);var b={correct:100*(g.results.filter(function(a){return 0<a.points}).length/g.terms.length),incorrect:100*(g.results.filter(function(a){return 0==a.points}).length/g.terms.length)};a("#progress-correct").css("width",b.correct+"%");a("#progress-incorrect").css("width",b.incorrect+"%");a("#question").html("");if(""!==g.terms[g.pointer].definition&&""!==g.terms[g.pointer].term){if(null!==g.terms[g.pointer].image&&""!=g.terms[g.pointer].image){a("#question").html("<img style='height:200px;width:auto;' class='center-block img-responsive img-thumbnail' src='"+g.terms[g.pointer].image+"'><br/>")}else if(g.has_images&&(null==g.terms[g.pointer].image||""==g.terms[g.pointer].term)){a("#question").html("<img style='height:200px;width:auto;' class='center-block img-responsive img-thumbnail' src='/images/no-image.png'><br/>")}a("#question").append("<strong>"+g.terms[g.pointer].definition+"</strong>")}else if(null!==g.terms[g.pointer].image&&""!=g.terms[g.pointer].image){a("#question").html("<img class='center-block img-responsive img-thumbnail' src='"+g.terms[g.pointer].image+"'>")}else{d.alert("Could not generate a test with these settings!","error");g.end()}},check:function check(b){var c=b.toLowerCase().trim()==g.terms[g.pointer].term.toLowerCase().trim(),d=0;if(!0==c){a("#submitted").addClass("a4e-correct");d=1}else{a("#submitted").addClass("a4e-incorrect")}if(c){this.reportSuccess(g.terms[g.pointer].id)}else{this.reportFailure(g.terms[g.pointer].id,0)}var e={question:g.terms[g.pointer].definition,selected:b,correct:g.terms[g.pointer].term,points:d,time:g.timer.count};g.timer.count=0;g.results.push(e);if(g.pointer<g.terms.length-1){g.pointer++;if(!c){a("#next-button").show()}else{setTimeout(function(){a("#next-button").trigger("click")},1e3)}}else{g.end()}},reportFailure:function reportFailure(a,c){if(this.dryRun){return}b.call([{methodname:"mod_wordcards_report_failed_association",args:{term1id:a,term2id:c}}])},reportSuccess:function reportSuccess(a){if(this.dryRun){return}b.call([{methodname:"mod_wordcards_report_successful_association",args:{termid:a}}])}};return g});
//# sourceMappingURL=matchtype.min.js.map
